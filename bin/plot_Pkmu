#!/usr/bin/env python
"""
 plot_Pkmu
 
 author: Nick Hand
 contact: nhand@berkeley.edu
 creation date: 06/13/2014
"""
import hod_mock
from flipper import flipperDict
import argparse
import pylab

if __name__ == '__main__':
    
    # parse the input arguments
    desc = "plot P(k, mu)"
    parser = argparse.ArgumentParser(description=desc)
    
    parser.add_argument('data_file', type=str, help="the file holding the data to plot") 
    parser.add_argument('param_file', type=str, help="the parameter file")
    
    args = parser.parse_args()
    
    params = flipperDict.flipperDict()
    params.readFromFile(args.param_file)
    
    mock = hod_mock.load(params['mock_file'])
    
    keys = ['bias', 'norm_linear', 'plot_linear', 'power_kwargs', 'plot_kwargs']
    kwargs = {k : params[k] for  k in params if k in keys and params.get(k, None) is not None}
    ax, mu = mock.plot_Pkmu(args.data_file, **kwargs)
    
    ax.legend(loc=0)
    ax.set_title(r"$P(k, \mu)$ at $\mu = %s$, assuming a bias of $b = %.2f$" %(mu, params['bias']))
    pylab.show()