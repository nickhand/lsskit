#!/usr/bin/env python
"""
 write_mock_coordinates
 write out the mock coordinates
 
 author: Nick Hand
 contact: nhand@berkeley.edu
 creation date: 06/18/2014
"""
import argparse
from flipper import flipperDict
import hod_mock

def main(params):
    """
    Write out a formatted coordinates of the mock
    """
    # load the mock file
    print "loading mock catalog..."
    mock = hod_mock.load(params['mock_file'])
     
    # clear any restrictions
    mock.clear_restrictions()
    
    # set the restrictions
    if params['galaxy_restrict'] is not None:
        mock.restrict_galaxies(params['galaxy_restrict'])

    if params['halo_restrict'] is not None:
        mock.restrict_halos(params['halo_restrict'])

    # write out the mock coordinates
    mock.write_coordinates(params['output_file'], params['output_fields'], 
                            units=params['output_units'], 
                            header=params['header'], 
                            temporary=False)
    
#end main
    
#-------------------------------------------------------------------------------
if __name__ == '__main__':
    
    # parse the input arguments
    desc = "write out the mock coordinates"
    parser = argparse.ArgumentParser(description=desc)
    parser.add_argument('param_file', type=str, help="the parameter file") 
    args = parser.parse_args()

    params = flipperDict.flipperDict()
    params.readFromFile(args.param_file)

    main(params)